# PenLight2

# Dependencies
```
cd path/to/PenLight2
pip install -r requirements.txt
```

# Data
The EC datasets used for training and evaluation can be downloaded from [here](https://www.dropbox.com/scl/fi/y4rbkayrzs3534hat9upl/data.tar.gz?rlkey=p70nawtp57vor0rwe4cwrcr5y&dl=0)
```
wget https://www.dropbox.com/scl/fi/y4rbkayrzs3534hat9upl/data.tar.gz?rlkey=p70nawtp57vor0rwe4cwrcr5y&dl=0 -O data.tar.gz
tar -xzvf data.tar.gz -C ./data

```

# Training
```
python scripts/train.py path/to/config
```
The configuration files can be found in directory `configs`. The default training configuration is `configs/train_EC.yml`.

# Inference
```
python scripts/infer_max_sep.py --model_dir path/to/model_dir --test_data path/to/test_data
```
`--model_dir`: the log directory generated by scripts/train.py.

`--test_data`: path to the test data file.

The inference results will be saved in `model_dir/max_sep_pred.csv`